<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Web Terminal</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #000;
      color: #00ff00;
      font-family: monospace;
      height: 100%;
    }
    #terminal {
      padding: 10px;
      box-sizing: border-box;
      height: 100%;
      overflow-y: auto;
      white-space: pre-wrap;
    }
    #input-line {
      display: flex;
    }
    #prompt {
      margin-right: 5px;
    }
    #cmd {
      background: none;
      border: none;
      outline: none;
      color: #00ff00;
      font-family: monospace;
      flex: 1;
    }
    .editor {
      border: 1px solid #00ff00;
      padding: 5px;
      margin-top: 5px;
    }
    textarea {
      width: 100%;
      height: 150px;
      background: #000;
      color: #00ff00;
      border: none;
      outline: none;
      font-family: monospace;
      resize: none;
    }
    button {
      background: #000;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 5px 10px;
      cursor: pointer;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div id="terminal"></div>
  <div id="input-line">
    <span id="prompt">$</span>
    <input id="cmd" autocomplete="off" autofocus />
  </div>  <script>
    const terminal = document.getElementById('terminal');
    const cmdInput = document.getElementById('cmd');

    let fs = { '/': {} };
    let cwd = '/';

    function print(text = '') {
      terminal.textContent += text + '\n';
      terminal.scrollTop = terminal.scrollHeight;
    }

    function resolvePath(path) {
      if (!path || path === '.') return cwd;
      if (path === '..') {
        if (cwd === '/') return '/';
        return cwd.split('/').slice(0, -2).join('/') + '/';
      }
      if (path.startsWith('/')) return path.endsWith('/') ? path : path + '/';
      return cwd + path + '/';
    }

    function getDir(path) {
      const parts = path.split('/').filter(Boolean);
      let cur = fs['/'];
      for (let p of parts) {
        if (!cur[p]) return null;
        cur = cur[p];
      }
      return cur;
    }

    function handleCommand(input) {
      const [command, ...args] = input.trim().split(' ');

      switch (command.toLowerCase()) {
        case 'help':
          print('Available commands:');
          print('help - show this message');
          print('mkdir <name> - create directory');
          print('ls - list directory');
          print('cd <dir> - change directory');
          print('texted <filename> - open text editor');
          break;

        case 'mkdir': {
          const name = args[0];
          if (!name) return print('mkdir: missing name');
          const dir = getDir(cwd);
          if (dir[name]) return print('mkdir: already exists');
          dir[name] = {};
          break;
        }

        case 'ls': {
          const dir = getDir(cwd);
          print(Object.keys(dir).join('  '));
          break;
        }

        case 'cd': {
          const target = args[0];
          if (!target) return;
          const newPath = resolvePath(target);
          const dir = getDir(newPath);
          if (!dir) return print('cd: no such directory');
          cwd = newPath;
          break;
        }

        case 'texted': {
          const filename = args[0] || 'file.txt';
          openEditor(filename);
          break;
        }

        case '':
          break;

        default:
          print('Unknown command: ' + command);
      }
    }

    function openEditor(filename) {
      print('--- texted ' + filename + ' ---');

      const editor = document.createElement('div');
      editor.className = 'editor';

      const textarea = document.createElement('textarea');
      editor.appendChild(textarea);

      const saveBtn = document.createElement('button');
      saveBtn.textContent = 'Save & Download';

      saveBtn.onclick = () => {
        const blob = new Blob([textarea.value], { type: 'text/plain' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = filename;
        a.click();
        URL.revokeObjectURL(a.href);
        print('Saved ' + filename);
        editor.remove();
      };

      editor.appendChild(saveBtn);
      terminal.appendChild(editor);
      terminal.scrollTop = terminal.scrollHeight;
    }

    cmdInput.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        const value = cmdInput.value;
        print('$ ' + value);
        handleCommand(value);
        cmdInput.value = '';
      }
    });

    print('Web Terminal started. Type "help"');
  </script></body>
</html>
